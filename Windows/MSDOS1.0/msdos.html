<!DOCTYPE html>
<html lang="en">
<head>
    <link rel="stylesheet" href="https://yopokiq.github.io/Emulators/Windows/styles/bg.css">
    <link rel="stylesheet" href="https://yopokiq.github.io/Emulators/Windows/styles/font.css">
    <link id="favicon" rel="icon" href="https://iili.io/205OIEP.png" type="image/png">
    <style>
        html, body, div, input {
            font-family: "Fixedsys 62";
        }

        #input-container .black span {
            pointer-events: none;
            user-select: none;
            display: inline-flex;
            align-items: center;
            margin-right: 5px;
            box-sizing: border-box;
        }

        #input-container .black {
            display: inline-flex;
            align-items: center;
        }

        #input-container .black div[contenteditable="true"] {
            display: inline-block;
            min-width: 50px;
            padding: 2px;
            border: 1px solid #aaa;
            margin: 0;
            vertical-align: middle;
            box-sizing: border-box;
        }

        #output-container {
            white-space: pre-wrap;
            margin-top: 0;
        }

        .black {
            color: #fff;
        }

        div[contenteditable="true"] {
            box-sizing: border-box;
        }

        #input-container .black div[contenteditable="true"] {
            margin: 0;
            padding: 0;
        }
    </style>

    <title>MS-DOS 1.0 Emulator</title>
</head>
<body class="black">
    <div class="black">
        MS-DOS Version 1.0<br>
        Copyright (C) Microsoft Corp 1981<br>
    </div>
    <div id="output-container" class="black"></div>
    <div id="input-container">
        <div class="black">
            <span>A:&gt;</span> 
            <div contenteditable="true" id="userInput"></div>
        </div>
    </div>

    <script>
        let files = {
            "A:\\": [
                {"filename": "MSDOS.SYS", "content": "<system-code-placeholder>"},
                {"filename": "IO.SYS", "content": "<system-code-placeholder>"},
                {"filename": "COMMAND.COM", "content": "<system-code-placeholder>"}
            ]
        };

        let currentDir = "A:\\";  // Default starting directory

        userInput = document.getElementById("userInput");
        outputContainer = document.getElementById("output-container");

        function printOutput(output) {
            outputContainer.textContent += output + "\n";
            outputContainer.scrollTop = outputContainer.scrollHeight; // Auto scroll
        }

        document.getElementById("userInput").addEventListener('keydown', function(event) {
            if (event.key === "Enter") {
                let inputText = userInput.innerText.trim();
                let commandOutput = '';

                // Parsing user input
                let [command, ...args] = inputText.split(" ");
                command = command.toUpperCase();
                args = args.join(" ").trim();

                switch (command) {
                    case "DIR":
                        commandOutput = "Directory of " + currentDir + "\n";
                        commandOutput += "No label\n";
                        commandOutput += "Directory of " + currentDir + "\n";
                        files[currentDir].forEach(file => {
                            commandOutput += file.filename + "\n";
                        });
                        break;
                    case "VER":
                        commandOutput = "MS-DOS version 1.0";
                        break;
                    case "COPY":
                        if (args) {
                            let [src, dest] = args.split(" ");
                            src = src.trim();
                            dest = dest.trim();
                            if (files[currentDir].some(file => file.filename === src)) {
                                files[currentDir].push({ "filename": dest, "content": "<copied-content>" });
                                commandOutput = `File ${src} copied to ${dest}`;
                            } else {
                                commandOutput = "File not found.";
                            }
                        } else {
                            commandOutput = "Invalid syntax. Usage: COPY [source] [destination]";
                        }
                        break;
                    case "DEL":
                        if (args) {
                            let fileIndex = files[currentDir].findIndex(file => file.filename === args);
                            if (fileIndex !== -1) {
                                files[currentDir].splice(fileIndex, 1);
                                commandOutput = `Deleted ${args}`;
                            } else {
                                commandOutput = "File not found.";
                            }
                        } else {
                            commandOutput = "Invalid syntax. Usage: DEL [filename]";
                        }
                        break;
                    default:
                        commandOutput = "Bad command or file name";
                }

                // Append the user's command and output to the output container
                printOutput(`A:> ${inputText}\n${commandOutput}\n`);
                userInput.innerText = ''; // Clear input field for new input
                event.preventDefault(); // Prevent the default behavior (like adding a newline in the input)
            }
        });
    </script>
</body>
</html>
